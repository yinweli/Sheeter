# 資料表單說明
![exceldata]

## 檔案名稱
檔案名稱必須符合以下規則  
* 名稱中若是包含`ignore`(不分大小寫)的檔案會被忽略
* 不是空字串
* 不能以數字開頭
* 只能使用以下符號: 英文字母, 數字, 空格, 底線

## 表單名稱
表單名稱必須符合以下規則  
* 名稱中若是包含`ignore`(不分大小寫)的表單會被忽略
* 不是空字串
* 只能使用以下符號: 英文字母, 數字, 空格, 底線

## 標籤行
標籤行用來控制該欄位的資料是否要輸出到資料檔案與程式碼中  
當設定檔中的標籤字串與欄位的標籤符合時, 該欄位就會被輸出  
欄位若是沒有設定標籤, 則不會輸出到資料檔案  
欄位的標籤若是包含`ignore`(不分大小寫), 則不會輸出到資料檔案與程式碼  
標籤為空格表示表格結尾  

## 名稱行
欄位名稱, 只能是英文與數字與`_`的組合, 並且不能以數字開頭, 也不允許空白  

## 註解行
欄位註解, 若為空格就輸出空註解, 若是有換行符號將會被移除 

## 欄位行
欄位類型設置, 以下是可用的類型  

| 類型                            | 說明                                           |
|:--------------------------------|:-----------------------------------------------|
| pkey                            | 表格主要索引, 使用32位元整數類型, 索引不可重複 |
| lkey                            | 表格主要索引, 使用64位元整數類型, 索引不可重複 |
| skey                            | 表格主要索引, 使用字串類型, 索引不可重複       |
| bool                            | 布林值                                         |
| boolArray, []bool, bool[]       | 以逗號分隔的布林值陣列                         |
| int                             | 32位元整數                                     |
| intArray, []int, int[]          | 以逗號分隔的32位元整數陣列                     |
| long                            | 64位元整數                                     |
| longArray, []long, long[]       | 以逗號分隔的64位元整數陣列                     |
| float                           | 32位元浮點數                                   |
| floatArray, []float, float[]    | 以逗號分隔的32位元浮點數陣列                   |
| double                          | 64位元浮點數                                   |
| doubleArray, []double, double[] | 以逗號分隔的64位元浮點數陣列                   |
| string                          | 字串                                           |
| stringArray, []string, string[] | 以逗號分隔的字串陣列                           |

## 資料行
依照類型填寫相應的內容即可, 空表格(也就是沒有任何資料行)是允許的, 遇到的第一個空行會被視為表格結束  

## 輸出欄
表格中的第一欄被用來決定該行是否要輸出  
當資料行的第一欄為`ignore`(不分大小寫), 該資料行不會輸出到資料檔案中  

## 其他的限制
* 表格設置
    * 表格必須有標籤行, 名稱行, 註解行, 欄位行, 但是可以不需要有資料行
    * 標籤行, 名稱行, 註解行, 欄位行必須在資料行之前
    * 設定檔中必須設定好標籤行, 名稱行, 註解行, 欄位行, 資料行的位置
    * 設定檔中行數是從1開始的
* 主索引
    * 表格必須有`pkey`/`lkey`/`skey`欄位
    * 表格只能有一個`pkey`/`lkey`/`skey`欄位
    * `pkey`/`lkey`/`skey`欄位中的內容不能重複

[exceldata]: doc/image/exceldata.jpg